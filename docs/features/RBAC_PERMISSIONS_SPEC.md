# ğŸ” ××¢×¨×›×ª ×”×¨×©××•×ª ××ª×§×“××ª (RBAC) - ××™×¤×™×•×Ÿ ××œ×

**×ª××¨×™×š:** 27/01/2026  
**×’×¨×¡×”:** 1.0  
**×¡×˜×˜×•×¡:** ××™×¤×™×•×Ÿ

---

## ğŸ“‹ ×ª×•×›×Ÿ ×¢× ×™×™× ×™×

1. [××¦×‘ ×§×™×™×](#1-××¦×‘-×§×™×™×)
2. [××˜×¨×•×ª ×”×©×™×¤×•×¨](#2-××˜×¨×•×ª-×”×©×™×¤×•×¨)
3. [××‘× ×” ×”×¨×©××•×ª ×—×“×©](#3-××‘× ×”-×”×¨×©××•×ª-×—×“×©)
4. [×”×¨×©××•×ª ×œ×¤×™ ×ª×¤×§×™×“](#4-×”×¨×©××•×ª-×œ×¤×™-×ª×¤×§×™×“)
5. [× ×™×”×•×œ ××©×ª××©×™× ×‘××¨×’×•×Ÿ](#5-× ×™×”×•×œ-××©×ª××©×™×-×‘××¨×’×•×Ÿ)
6. [×—×¡×™××ª ××©×ª××©×™×](#6-×—×¡×™××ª-××©×ª××©×™×)
7. [××•×“×œ × ×ª×•× ×™×](#7-××•×“×œ-× ×ª×•× ×™×)
8. [API Endpoints](#8-api-endpoints)
9. [×××©×§ ××©×ª××©](#9-×××©×§-××©×ª××©)
10. [×ª×›× ×™×ª ×™×™×©×•×](#10-×ª×›× ×™×ª-×™×™×©×•×)

---

## 1. ××¦×‘ ×§×™×™×

### ××” ×§×™×™× ×”×™×•×?

```python
class UserRole(str, enum.Enum):
    ADMIN = "ADMIN"
    DISPATCHER = "DISPATCHER"
    ACCOUNTING = "ACCOUNTING"
    DRIVER = "DRIVER"
```

### ×‘×¢×™×•×ª ×‘××¦×‘ ×”×§×™×™×

| ×‘×¢×™×” | ×ª×™××•×¨ |
|------|-------|
| âŒ ××™×Ÿ ×”×™×¨×¨×›×™×” | ×›×œ ×”×ª×¤×§×™×“×™× ×©×•×•×™× |
| âŒ ××™×Ÿ Owner | ××™ ×©×™×¦×¨ ××ª ×”××¨×’×•×Ÿ ×œ× ××–×•×”×” |
| âŒ ××™×Ÿ ×—×¡×™××” | ××™ ××¤×©×¨ ×œ×—×¡×•× ××©×ª××© ×‘×œ×™ ×œ××—×•×§ |
| âŒ ×”×¨×©××•×ª ×’×¡×•×ª | ×”×›×œ ××• ×›×œ×•× |
| âŒ ××™×Ÿ Audit | ×œ× ×™×•×“×¢×™× ××™ ×©×™× ×” ×”×¨×©××•×ª |
| âŒ ××™×Ÿ ×”×–×× ×•×ª | ××™×Ÿ ×× ×’× ×•×Ÿ ×œ×”×–××™×Ÿ ××©×ª××©×™× |

---

## 2. ××˜×¨×•×ª ×”×©×™×¤×•×¨

### ×™×¢×“×™× ×¢×™×§×¨×™×™×

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Project Goals                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  âœ… ×”×™×¨×¨×›×™×” ×‘×¨×•×¨×” - Owner > Admin > Manager > User          â”‚
â”‚  âœ… ×”×¨×©××•×ª ×’×¨× ×•×œ×¨×™×•×ª - ×©×œ×™×˜×” ×‘×¨××ª ×¤×¢×•×œ×”                     â”‚
â”‚  âœ… ×—×¡×™××”/×”×©×”×™×” - ×œ×œ× ××—×™×§×”                                 â”‚
â”‚  âœ… × ×™×”×•×œ ×¢×¦××™ - Owner ×× ×”×œ ××ª ×”××¨×’×•×Ÿ ×©×œ×•                   â”‚
â”‚  âœ… ×”×–×× ×•×ª - ×× ×’× ×•×Ÿ ×”×–×× ×ª ××©×ª××©×™× ×—×“×©×™×                     â”‚
â”‚  âœ… Audit - ×œ×•×’ ×©×™× ×•×™×™× ×‘×”×¨×©××•×ª                             â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. ××‘× ×” ×”×¨×©××•×ª ×—×“×©

### ×”×™×¨×¨×›×™×™×ª ×ª×¤×§×™×“×™×

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   SUPER_ADMIN   â”‚  â† ×× ×”×œ ××¢×¨×›×ª (×¨×§ ××—×“)
                    â”‚   (System)      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                             â”‚
              â–¼                             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚     OWNER       â”‚           â”‚     OWNER       â”‚
    â”‚   (Org A)       â”‚           â”‚   (Org B)       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                 â”‚           â”‚                 â”‚
    â–¼                 â–¼           â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”
â”‚ ADMIN â”‚       â”‚ ADMIN â”‚    â”‚ ADMIN â”‚       â”‚ ADMIN â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”˜       â””â”€â”€â”€â”¬â”€â”€â”€â”˜    â””â”€â”€â”€â”¬â”€â”€â”€â”˜       â””â”€â”€â”€â”¬â”€â”€â”€â”˜
    â”‚               â”‚            â”‚               â”‚
    â–¼               â–¼            â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DISPATCHER â”‚ ACCOUNTING â”‚  â”‚ DISPATCHER â”‚ ACCOUNTING â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                            â”‚
         â–¼                            â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ DRIVER  â”‚                  â”‚ DRIVER  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ×ª×¤×§×™×“×™× ×—×“×©×™×

```python
class OrgRole(str, enum.Enum):
    """×ª×¤×§×™×“×™× ×‘×ª×•×š ××¨×’×•×Ÿ"""
    
    OWNER = "owner"           # ×‘×¢×œ×™× - ×©×œ×™×˜×” ××œ××”
    ADMIN = "admin"           # ×× ×”×œ - ×›××¢×˜ ×”×›×œ ×—×•×¥ ××”×¢×‘×¨×ª ×‘×¢×œ×•×ª
    DISPATCHER = "dispatcher" # ×¡×“×¨×Ÿ - × ×™×”×•×œ × ×¡×™×¢×•×ª ×•×¦×™
    ACCOUNTING = "accounting" # ×”× ×”"×— - ×›×¡×¤×™× ×‘×œ×‘×“
    DRIVER = "driver"         # × ×”×’ - ×¨×§ ×”××©×™××•×ª ×©×œ×•
    VIEWER = "viewer"         # ×¦×•×¤×” - ×§×¨×™××” ×‘×œ×‘×“ (×œ×§×•×—×•×ª?)
```

---

## 4. ×”×¨×©××•×ª ×œ×¤×™ ×ª×¤×§×™×“

### ××˜×¨×™×¦×ª ×”×¨×©××•×ª ××œ××”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           Permission Matrix                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ×¤×¢×•×œ×”              â”‚ Owner â”‚ Admin â”‚ Dispatcher â”‚ Accounting â”‚ Driver â”‚ Viewer â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ × ×™×”×•×œ ××©×ª××©×™×      â”‚                                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ×”×–×× ×ª ××©×ª××©×™×      â”‚  âœ…   â”‚  âœ…   â”‚     âŒ     â”‚     âŒ     â”‚   âŒ   â”‚   âŒ   â”‚
â”‚ ×”×’×“×¨×ª ×ª×¤×§×™×“×™×      â”‚  âœ…   â”‚  âœ…   â”‚     âŒ     â”‚     âŒ     â”‚   âŒ   â”‚   âŒ   â”‚
â”‚ ×—×¡×™××ª ××©×ª××©×™×      â”‚  âœ…   â”‚  âœ…   â”‚     âŒ     â”‚     âŒ     â”‚   âŒ   â”‚   âŒ   â”‚
â”‚ ××—×™×§×ª ××©×ª××©×™×      â”‚  âœ…   â”‚  âš ï¸*  â”‚     âŒ     â”‚     âŒ     â”‚   âŒ   â”‚   âŒ   â”‚
â”‚ ×”×¢×‘×¨×ª ×‘×¢×œ×•×ª        â”‚  âœ…   â”‚  âŒ   â”‚     âŒ     â”‚     âŒ     â”‚   âŒ   â”‚   âŒ   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ×”×’×“×¨×•×ª ××¨×’×•×Ÿ       â”‚                                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ×¢×¨×™×›×ª ×¤×¨×˜×™ ××¨×’×•×Ÿ   â”‚  âœ…   â”‚  âœ…   â”‚     âŒ     â”‚     âŒ     â”‚   âŒ   â”‚   âŒ   â”‚
â”‚ ×©×™× ×•×™ ×œ×•×’×•/××™×ª×•×’   â”‚  âœ…   â”‚  âœ…   â”‚     âŒ     â”‚     âŒ     â”‚   âŒ   â”‚   âŒ   â”‚
â”‚ ×”×’×“×¨×•×ª ×—×™×•×‘        â”‚  âœ…   â”‚  âŒ   â”‚     âŒ     â”‚     âŒ     â”‚   âŒ   â”‚   âŒ   â”‚
â”‚ ×©×“×¨×•×’/×‘×™×˜×•×œ ×× ×•×™   â”‚  âœ…   â”‚  âŒ   â”‚     âŒ     â”‚     âŒ     â”‚   âŒ   â”‚   âŒ   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ×œ×§×•×—×•×ª ×•××ª×¨×™×      â”‚                                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ×¦×¤×™×™×” ×‘×œ×§×•×—×•×ª      â”‚  âœ…   â”‚  âœ…   â”‚     âœ…     â”‚     âœ…     â”‚   âŒ   â”‚   âœ…   â”‚
â”‚ ×™×¦×™×¨×ª ×œ×§×•×—         â”‚  âœ…   â”‚  âœ…   â”‚     âœ…     â”‚     âŒ     â”‚   âŒ   â”‚   âŒ   â”‚
â”‚ ×¢×¨×™×›×ª ×œ×§×•×—         â”‚  âœ…   â”‚  âœ…   â”‚     âœ…     â”‚     âŒ     â”‚   âŒ   â”‚   âŒ   â”‚
â”‚ ××—×™×§×ª ×œ×§×•×—         â”‚  âœ…   â”‚  âœ…   â”‚     âŒ     â”‚     âŒ     â”‚   âŒ   â”‚   âŒ   â”‚
â”‚ ×¦×¤×™×™×” ×‘××ª×¨×™×       â”‚  âœ…   â”‚  âœ…   â”‚     âœ…     â”‚     âœ…     â”‚   âš ï¸** â”‚   âœ…   â”‚
â”‚ × ×™×”×•×œ ××ª×¨×™×        â”‚  âœ…   â”‚  âœ…   â”‚     âœ…     â”‚     âŒ     â”‚   âŒ   â”‚   âŒ   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ×¦×™ (××©××™×•×ª/× ×”×’×™×)  â”‚                                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ×¦×¤×™×™×” ×‘×¦×™          â”‚  âœ…   â”‚  âœ…   â”‚     âœ…     â”‚     âœ…     â”‚   âš ï¸** â”‚   âœ…   â”‚
â”‚ ×”×•×¡×¤×ª ××©××™×ª        â”‚  âœ…   â”‚  âœ…   â”‚     âŒ     â”‚     âŒ     â”‚   âŒ   â”‚   âŒ   â”‚
â”‚ ×¢×¨×™×›×ª ××©××™×ª        â”‚  âœ…   â”‚  âœ…   â”‚     âš ï¸*** â”‚     âŒ     â”‚   âŒ   â”‚   âŒ   â”‚
â”‚ ×”×•×¡×¤×ª × ×”×’          â”‚  âœ…   â”‚  âœ…   â”‚     âŒ     â”‚     âŒ     â”‚   âŒ   â”‚   âŒ   â”‚
â”‚ ×¢×¨×™×›×ª × ×”×’          â”‚  âœ…   â”‚  âœ…   â”‚     âš ï¸*** â”‚     âŒ     â”‚   âŒ   â”‚   âŒ   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ × ×¡×™×¢×•×ª             â”‚                                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ×¦×¤×™×™×” ×‘× ×¡×™×¢×•×ª      â”‚  âœ…   â”‚  âœ…   â”‚     âœ…     â”‚     âœ…     â”‚  âš ï¸****â”‚   âœ…   â”‚
â”‚ ×™×¦×™×¨×ª × ×¡×™×¢×”        â”‚  âœ…   â”‚  âœ…   â”‚     âœ…     â”‚     âŒ     â”‚   âŒ   â”‚   âŒ   â”‚
â”‚ ×¢×¨×™×›×ª × ×¡×™×¢×”        â”‚  âœ…   â”‚  âœ…   â”‚     âœ…     â”‚     âŒ     â”‚   âŒ   â”‚   âŒ   â”‚
â”‚ ×©×™×•×š × ×”×’/××©××™×ª     â”‚  âœ…   â”‚  âœ…   â”‚     âœ…     â”‚     âŒ     â”‚   âŒ   â”‚   âŒ   â”‚
â”‚ ×¢×“×›×•×Ÿ ×¡×˜×˜×•×¡        â”‚  âœ…   â”‚  âœ…   â”‚     âœ…     â”‚     âŒ     â”‚   âœ…   â”‚   âŒ   â”‚
â”‚ ××—×™×§×ª × ×¡×™×¢×”        â”‚  âœ…   â”‚  âœ…   â”‚     âš ï¸*****â”‚     âŒ     â”‚   âŒ   â”‚   âŒ   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ×›×¡×¤×™×              â”‚                                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ×¦×¤×™×™×” ×‘××—×™×¨×•× ×™×    â”‚  âœ…   â”‚  âœ…   â”‚     âœ…     â”‚     âœ…     â”‚   âŒ   â”‚   âŒ   â”‚
â”‚ ×¢×¨×™×›×ª ××—×™×¨×•× ×™×     â”‚  âœ…   â”‚  âœ…   â”‚     âŒ     â”‚     âœ…     â”‚   âŒ   â”‚   âŒ   â”‚
â”‚ ×¦×¤×™×™×” ×‘×—×©×‘×•× ×™×•×ª    â”‚  âœ…   â”‚  âœ…   â”‚     âŒ     â”‚     âœ…     â”‚   âŒ   â”‚   âŒ   â”‚
â”‚ ×™×¦×™×¨×ª ×—×©×‘×•× ×™×ª      â”‚  âœ…   â”‚  âœ…   â”‚     âŒ     â”‚     âœ…     â”‚   âŒ   â”‚   âŒ   â”‚
â”‚ ×¨×™×©×•× ×ª×©×œ×•×        â”‚  âœ…   â”‚  âœ…   â”‚     âŒ     â”‚     âœ…     â”‚   âŒ   â”‚   âŒ   â”‚
â”‚ ×¨×™×©×•× ×”×•×¦××”        â”‚  âœ…   â”‚  âœ…   â”‚     âŒ     â”‚     âœ…     â”‚   âŒ   â”‚   âŒ   â”‚
â”‚ Override ××—×™×¨      â”‚  âœ…   â”‚  âœ…   â”‚     âŒ     â”‚     âœ…     â”‚   âŒ   â”‚   âŒ   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ×“×•×—×•×ª              â”‚                                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ×“×•×—×•×ª ×ª×¤×¢×•×œ×™×™×     â”‚  âœ…   â”‚  âœ…   â”‚     âœ…     â”‚     âœ…     â”‚   âŒ   â”‚   âœ…   â”‚
â”‚ ×“×•×—×•×ª ×›×¡×¤×™×™×       â”‚  âœ…   â”‚  âœ…   â”‚     âŒ     â”‚     âœ…     â”‚   âŒ   â”‚   âŒ   â”‚
â”‚ ×™×™×¦×•× × ×ª×•× ×™×       â”‚  âœ…   â”‚  âœ…   â”‚     âœ…     â”‚     âœ…     â”‚   âŒ   â”‚   âŒ   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜

×”×¢×¨×•×ª:
* Admin ×œ× ×™×›×•×œ ×œ××—×•×§ Owner ××• Admin ××—×¨
** Driver ×¨×•××” ×¨×§ ××ª ×”××ª×¨×™×/××©××™×•×ª ×”×§×©×•×¨×™× ×œ× ×¡×™×¢×•×ª ×©×œ×•
*** Dispatcher ×™×›×•×œ ×œ×¢×¨×•×š ×¨×§ status/×–××™× ×•×ª
**** Driver ×¨×•××” ×¨×§ × ×¡×™×¢×•×ª ××©×•×™×›×•×ª ××œ×™×•
***** Dispatcher ×™×›×•×œ ×œ××—×•×§ ×¨×§ × ×¡×™×¢×•×ª ×‘×¡×˜×˜×•×¡ PLANNED
```

---

## 5. × ×™×”×•×œ ××©×ª××©×™× ×‘××¨×’×•×Ÿ

### ×ª×”×œ×™×š ×”×–×× ×ª ××©×ª××©

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   User Invitation Flow                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  1. Owner/Admin ××–×™×Ÿ ××™××™×™×œ + ×ª×¤×§×™×“                         â”‚
â”‚         â†“                                                    â”‚
â”‚  2. ××¢×¨×›×ª ×™×•×¦×¨×ª invitation token (24 ×©×¢×•×ª ×ª×•×§×£)            â”‚
â”‚         â†“                                                    â”‚
â”‚  3. ××™××™×™×œ × ×©×œ×— ×œ××•×–××Ÿ                                      â”‚
â”‚         â†“                                                    â”‚
â”‚  4. ××©×ª××© ×œ×•×—×¥ ×¢×œ ×œ×™× ×§ ×•××’×“×™×¨ ×¡×™×¡××”                        â”‚
â”‚         â†“                                                    â”‚
â”‚  5. ×—×©×‘×•×Ÿ × ×•×¦×¨ + ×ª×¤×§×™×“ ××©×•×™×š                               â”‚
â”‚         â†“                                                    â”‚
â”‚  6. Audit log × ×¨×©×                                          â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ×¡×˜×˜×•×¡×™ ××©×ª××©

```python
class UserStatus(str, enum.Enum):
    PENDING = "pending"       # ×”×•×–××Ÿ, ×˜×¨× ×”×¤×¢×™×œ
    ACTIVE = "active"         # ×¤×¢×™×œ
    SUSPENDED = "suspended"   # ××•×©×”×” (×—×¡×•× ×–×× ×™×ª)
    BLOCKED = "blocked"       # ×—×¡×•× (×§×‘×•×¢)
    DELETED = "deleted"       # ××—×•×§ (soft delete)
```

### ××¦×‘×™ ××©×ª××©

```
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ PENDING  â”‚ â† ×”×–×× ×” × ×©×œ×—×”
            â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                 â”‚ ×”×¤×¢×œ×”
                 â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”Œâ”€â”€â”€â”€â”€â”€â”‚  ACTIVE  â”‚â”€â”€â”€â”€â”€â”€â”
     â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
     â”‚                        â”‚
     â”‚ ×”×©×”×™×”              ×—×¡×™××”
     â–¼                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚SUSPENDED â”‚           â”‚ BLOCKED  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚ ×”×¤×¢×œ×” ××—×“×©            â”‚
     â”‚                       â”‚
     â–¼                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  ACTIVE  â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
                             â”‚ ××—×™×§×”
                             â–¼
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚ DELETED  â”‚ â† Soft Delete
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. ×—×¡×™××ª ××©×ª××©×™×

### ×¡×•×’×™ ×—×¡×™××”

| ×¡×•×’ | ×ª×™××•×¨ | ××™ ×™×›×•×œ | ×”×¤×™×š? |
|-----|-------|---------|-------|
| **×”×©×”×™×” (Suspend)** | ×—×¡×™××” ×–×× ×™×ª | Owner, Admin | âœ… ×›×Ÿ |
| **×—×¡×™××” (Block)** | ×—×¡×™××” ×§×‘×•×¢×” | Owner, Admin | âœ… ×›×Ÿ (×¨×§ Owner) |
| **××—×™×§×” (Delete)** | Soft delete | Owner | âš ï¸ 30 ×™×•× |

### ××” ×§×•×¨×” ×›×©×—×•×¡××™×?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  When User is Blocked                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  âŒ ×œ× ×™×›×•×œ ×œ×”×ª×—×‘×¨ ×œ××¢×¨×›×ª                                   â”‚
â”‚  âŒ JWT tokens ×§×™×™××™× ××‘×•×˜×œ×™×                               â”‚
â”‚  âŒ ××™× ×• ××•×¤×™×¢ ×‘×¨×©×™××•×ª ×‘×—×™×¨×” (× ×”×’×™×, ××©×ª××©×™×)               â”‚
â”‚  âœ… × ×¡×™×¢×•×ª ×§×™×™××•×ª × ×©××¨×•×ª (×”×™×¡×˜×•×¨×™×”)                        â”‚
â”‚  âœ… × ×ª×•× ×™× × ×©××¨×™× ×œ×“×•×—×•×ª                                    â”‚
â”‚  âš ï¸ × ×¡×™×¢×•×ª ×¢×ª×™×“×™×•×ª ××©×•×™×›×•×ª - ×”×ª×¨××” ×œ-Admin                 â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ×—×•×§×™ ×—×¡×™××”

```python
class BlockingRules:
    """×—×•×§×™× ×œ×—×¡×™××ª ××©×ª××©×™×"""
    
    # Owner ×œ× ×™×›×•×œ ×œ×—×¡×•× ××ª ×¢×¦××•
    OWNER_CANNOT_BLOCK_SELF = True
    
    # Admin ×œ× ×™×›×•×œ ×œ×—×¡×•× Owner
    ADMIN_CANNOT_BLOCK_OWNER = True
    
    # Admin ×œ× ×™×›×•×œ ×œ×—×¡×•× Admin ××—×¨
    ADMIN_CANNOT_BLOCK_ADMIN = True
    
    # ×—×™×™×‘ ×œ×”×™×•×ª ×œ×¤×—×•×ª Owner ××—×“ ×¤×¢×™×œ
    MUST_HAVE_ACTIVE_OWNER = True
    
    # ×¡×™×‘×” ×—×•×‘×” ×œ×—×¡×™××”
    REASON_REQUIRED = True
    
    # ×”×ª×¨××” ×œ× ×”×’ ×¢×œ × ×¡×™×¢×•×ª ×¢×ª×™×“×™×•×ª
    NOTIFY_FUTURE_JOBS = True
```

---

## 7. ××•×“×œ × ×ª×•× ×™×

### ×˜×‘×œ××•×ª ×—×“×©×•×ª

```sql
-- ===== ×¢×“×›×•×Ÿ ×˜×‘×œ×ª users =====
ALTER TABLE users ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'active';
ALTER TABLE users ADD COLUMN IF NOT EXISTS blocked_at TIMESTAMP;
ALTER TABLE users ADD COLUMN IF NOT EXISTS blocked_by INTEGER REFERENCES users(id);
ALTER TABLE users ADD COLUMN IF NOT EXISTS blocked_reason TEXT;
ALTER TABLE users ADD COLUMN IF NOT EXISTS suspended_at TIMESTAMP;
ALTER TABLE users ADD COLUMN IF NOT EXISTS suspended_by INTEGER REFERENCES users(id);
ALTER TABLE users ADD COLUMN IF NOT EXISTS suspended_reason TEXT;
ALTER TABLE users ADD COLUMN IF NOT EXISTS last_login_at TIMESTAMP;
ALTER TABLE users ADD COLUMN IF NOT EXISTS invited_by INTEGER REFERENCES users(id);
ALTER TABLE users ADD COLUMN IF NOT EXISTS invited_at TIMESTAMP;

-- ××™× ×“×§×¡×™×
CREATE INDEX idx_users_status ON users(org_id, status);
CREATE INDEX idx_users_role ON users(org_id, org_role);


-- ===== ×˜×‘×œ×ª ×”×–×× ×•×ª =====
CREATE TABLE user_invitations (
    id SERIAL PRIMARY KEY,
    org_id UUID NOT NULL REFERENCES organizations(id) ON DELETE CASCADE,
    
    -- ×¤×¨×˜×™ ×”×”×–×× ×”
    email VARCHAR(255) NOT NULL,
    role VARCHAR(50) NOT NULL,
    token VARCHAR(100) UNIQUE NOT NULL,
    
    -- ××˜×
    invited_by INTEGER NOT NULL REFERENCES users(id),
    invited_at TIMESTAMP DEFAULT NOW(),
    expires_at TIMESTAMP NOT NULL,
    
    -- ×¡×˜×˜×•×¡
    status VARCHAR(20) DEFAULT 'pending',  -- pending, accepted, expired, cancelled
    accepted_at TIMESTAMP,
    accepted_by INTEGER REFERENCES users(id),
    
    -- ×”×’×‘×œ×•×ª
    max_uses INTEGER DEFAULT 1,
    current_uses INTEGER DEFAULT 0
);

CREATE INDEX idx_invitations_token ON user_invitations(token);
CREATE INDEX idx_invitations_email ON user_invitations(org_id, email);


-- ===== ×˜×‘×œ×ª ×œ×•×’ ×”×¨×©××•×ª =====
CREATE TABLE permission_audit_logs (
    id SERIAL PRIMARY KEY,
    org_id UUID NOT NULL REFERENCES organizations(id) ON DELETE CASCADE,
    
    -- ××” ×§×¨×”
    action VARCHAR(50) NOT NULL,  -- role_changed, user_blocked, user_invited, etc.
    entity_type VARCHAR(50) NOT NULL,  -- user, invitation
    entity_id INTEGER NOT NULL,
    
    -- ××™ ×¢×©×”
    performed_by INTEGER NOT NULL REFERENCES users(id),
    performed_at TIMESTAMP DEFAULT NOW(),
    
    -- ×¤×¨×˜×™×
    old_value JSONB,
    new_value JSONB,
    reason TEXT,
    ip_address VARCHAR(45),
    user_agent TEXT
);

CREATE INDEX idx_permission_audit_org ON permission_audit_logs(org_id, performed_at);
CREATE INDEX idx_permission_audit_user ON permission_audit_logs(entity_id, action);


-- ===== ×˜×‘×œ×ª ×”×¨×©××•×ª ××•×ª×××•×ª ××™×©×™×ª (Phase 2) =====
CREATE TABLE custom_permissions (
    id SERIAL PRIMARY KEY,
    org_id UUID NOT NULL REFERENCES organizations(id) ON DELETE CASCADE,
    user_id INTEGER NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    
    -- ×”×¨×©××” ×¡×¤×¦×™×¤×™×ª
    permission VARCHAR(100) NOT NULL,  -- customers.create, jobs.delete, etc.
    granted BOOLEAN DEFAULT TRUE,
    
    -- ××˜×
    granted_by INTEGER REFERENCES users(id),
    granted_at TIMESTAMP DEFAULT NOW(),
    expires_at TIMESTAMP,
    reason TEXT,
    
    UNIQUE(org_id, user_id, permission)
);

CREATE INDEX idx_custom_permissions_user ON custom_permissions(user_id, permission);
```

### ×¢×“×›×•×Ÿ User Model

```python
# backend/app/models/user.py

class User(Base):
    __tablename__ = "users"
    
    id = Column(Integer, primary_key=True, index=True)
    org_id = Column(UUID(as_uuid=True), ForeignKey("organizations.id"), nullable=False)
    
    # ×¤×¨×˜×™× ×‘×¡×™×¡×™×™×
    email = Column(String(255), unique=True, nullable=False)
    name = Column(String(255), nullable=False)
    phone = Column(String(20))
    password_hash = Column(String(255), nullable=False)
    
    # ×ª×¤×§×™×“ ×•×”×¨×©××•×ª
    org_role = Column(String(50), default='viewer')  # owner, admin, dispatcher, accounting, driver, viewer
    is_super_admin = Column(Boolean, default=False)
    
    # ×¡×˜×˜×•×¡
    status = Column(String(20), default='active')  # pending, active, suspended, blocked, deleted
    is_active = Column(Boolean, default=True)  # Legacy, keep for compatibility
    
    # ×—×¡×™××”
    blocked_at = Column(DateTime(timezone=True))
    blocked_by = Column(Integer, ForeignKey("users.id"))
    blocked_reason = Column(Text)
    
    # ×”×©×”×™×”
    suspended_at = Column(DateTime(timezone=True))
    suspended_by = Column(Integer, ForeignKey("users.id"))
    suspended_reason = Column(Text)
    suspended_until = Column(DateTime(timezone=True))  # ××•×¤×¦×™×•× ×œ×™ - ×”×©×”×™×” ×–×× ×™×ª
    
    # ××˜×
    last_login_at = Column(DateTime(timezone=True))
    invited_by = Column(Integer, ForeignKey("users.id"))
    invited_at = Column(DateTime(timezone=True))
    created_at = Column(DateTime(timezone=True), server_default=func.now())
    updated_at = Column(DateTime(timezone=True), onupdate=func.now())
    
    # Relationships
    organization = relationship("Organization", back_populates="users")
    driver_profile = relationship("Driver", back_populates="user", uselist=False)
    
    @property
    def can_login(self) -> bool:
        """×”×× ×”××©×ª××© ×™×›×•×œ ×œ×”×ª×—×‘×¨"""
        return self.status == 'active' and self.is_active
    
    @property
    def is_owner(self) -> bool:
        return self.org_role == 'owner'
    
    @property
    def is_admin(self) -> bool:
        return self.org_role in ('owner', 'admin')
    
    @property
    def is_dispatcher(self) -> bool:
        return self.org_role in ('owner', 'admin', 'dispatcher')
    
    @property
    def is_accounting(self) -> bool:
        return self.org_role in ('owner', 'admin', 'accounting')
```

---

## 8. API Endpoints

### × ×™×”×•×œ ××©×ª××©×™× ×‘××¨×’×•×Ÿ

```python
# ===== GET /api/org/users =====
# ×¨×©×™××ª ××©×ª××©×™× ×‘××¨×’×•×Ÿ
# Permissions: owner, admin

Response:
{
    "total": 15,
    "items": [
        {
            "id": 1,
            "email": "owner@company.com",
            "name": "×‘×¢×œ×™×",
            "org_role": "owner",
            "status": "active",
            "last_login_at": "2026-01-27T10:00:00Z",
            "created_at": "2026-01-01T00:00:00Z"
        },
        ...
    ]
}


# ===== POST /api/org/users/invite =====
# ×”×–×× ×ª ××©×ª××© ×—×“×©
# Permissions: owner, admin

Request:
{
    "email": "new@company.com",
    "role": "dispatcher",
    "message": "×”×•×–×× ×ª ×œ×”×¦×˜×¨×£ ×œ××¢×¨×›×ª"  // optional
}

Response:
{
    "invitation_id": 123,
    "email": "new@company.com",
    "role": "dispatcher",
    "expires_at": "2026-01-28T10:00:00Z",
    "invite_url": "https://app.com/invite/abc123..."
}


# ===== PATCH /api/org/users/{user_id}/role =====
# ×©×™× ×•×™ ×ª×¤×§×™×“
# Permissions: owner (all), admin (limited)

Request:
{
    "role": "admin",
    "reason": "×§×™×“×•× ×œ×ª×¤×§×™×“ ×× ×”×œ"
}

Response:
{
    "user_id": 5,
    "old_role": "dispatcher",
    "new_role": "admin",
    "changed_by": 1,
    "changed_at": "2026-01-27T10:00:00Z"
}


# ===== POST /api/org/users/{user_id}/suspend =====
# ×”×©×”×™×™×ª ××©×ª××©
# Permissions: owner, admin

Request:
{
    "reason": "×—×•×¤×©×” ××¨×•×›×”",
    "until": "2026-02-27T00:00:00Z"  // optional
}

Response:
{
    "user_id": 5,
    "status": "suspended",
    "suspended_at": "2026-01-27T10:00:00Z",
    "suspended_until": "2026-02-27T00:00:00Z",
    "reason": "×—×•×¤×©×” ××¨×•×›×”"
}


# ===== POST /api/org/users/{user_id}/block =====
# ×—×¡×™××ª ××©×ª××©
# Permissions: owner, admin

Request:
{
    "reason": "×¡×™×•× ×”×¢×¡×§×”"
}

Response:
{
    "user_id": 5,
    "status": "blocked",
    "blocked_at": "2026-01-27T10:00:00Z",
    "reason": "×¡×™×•× ×”×¢×¡×§×”",
    "affected_jobs": [
        {"job_id": 101, "date": "2026-01-28", "status": "ASSIGNED"}
    ]
}


# ===== POST /api/org/users/{user_id}/activate =====
# ×”×¤×¢×œ×” ××—×“×©
# Permissions: owner (blocked), owner/admin (suspended)

Response:
{
    "user_id": 5,
    "status": "active",
    "activated_at": "2026-01-27T10:00:00Z",
    "activated_by": 1
}


# ===== DELETE /api/org/users/{user_id} =====
# ××—×™×§×ª ××©×ª××© (soft delete)
# Permissions: owner only

Request:
{
    "confirm": true,
    "reason": "×‘×§×©×ª ××©×ª××©"
}

Response:
{
    "user_id": 5,
    "status": "deleted",
    "deleted_at": "2026-01-27T10:00:00Z",
    "recoverable_until": "2026-02-26T10:00:00Z"
}


# ===== POST /api/org/transfer-ownership =====
# ×”×¢×‘×¨×ª ×‘×¢×œ×•×ª
# Permissions: owner only

Request:
{
    "new_owner_id": 5,
    "confirm_password": "current_password",
    "reason": "×”×¢×‘×¨×ª ×‘×¢×œ×•×ª ×œ×©×•×ª×£"
}

Response:
{
    "success": true,
    "old_owner_id": 1,
    "new_owner_id": 5,
    "old_owner_new_role": "admin",
    "transferred_at": "2026-01-27T10:00:00Z"
}
```

### ×œ×•×’ ×¤×¢×•×œ×•×ª

```python
# ===== GET /api/org/audit-log =====
# ×œ×•×’ ×©×™× ×•×™×™ ×”×¨×©××•×ª
# Permissions: owner, admin

Query params:
- action: role_changed, user_blocked, user_invited, etc.
- user_id: filter by affected user
- from_date, to_date: date range
- limit, offset: pagination

Response:
{
    "total": 150,
    "items": [
        {
            "id": 1,
            "action": "user_blocked",
            "entity_type": "user",
            "entity_id": 5,
            "performed_by": {
                "id": 1,
                "name": "×‘×¢×œ×™×",
                "email": "owner@company.com"
            },
            "performed_at": "2026-01-27T10:00:00Z",
            "old_value": {"status": "active"},
            "new_value": {"status": "blocked"},
            "reason": "×¡×™×•× ×”×¢×¡×§×”"
        }
    ]
}
```

---

## 9. ×××©×§ ××©×ª××©

### ×¢××•×“ × ×™×”×•×œ ××©×ª××©×™×

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† × ×™×”×•×œ ××©×ª××©×™×                                              + ×”×–××Ÿ ××©×ª××©     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚  ğŸ” ×—×™×¤×•×©...                    [×›×•×œ× â–¼]  [×›×œ ×”×¡×˜×˜×•×¡×™× â–¼]                       â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ‘¤ ×©×            â”‚ ××™××™×™×œ              â”‚ ×ª×¤×§×™×“      â”‚ ×¡×˜×˜×•×¡  â”‚ ×¤×¢×•×œ×•×ª    â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ ğŸ”‘ ×™×•×¡×™ ×›×”×Ÿ      â”‚ yosi@company.com    â”‚ ğŸ‘‘ ×‘×¢×œ×™×   â”‚ ğŸŸ¢ ×¤×¢×™×œ â”‚ â€¢â€¢â€¢      â”‚  â”‚
â”‚  â”‚ â­ ×©×¨×” ×œ×•×™       â”‚ sara@company.com    â”‚ ğŸ›¡ï¸ ×× ×”×œ    â”‚ ğŸŸ¢ ×¤×¢×™×œ â”‚ â€¢â€¢â€¢      â”‚  â”‚
â”‚  â”‚ ğŸ“‹ ××©×” ×’×•×œ×Ÿ      â”‚ moshe@company.com   â”‚ ğŸ“‹ ×¡×“×¨×Ÿ    â”‚ ğŸŸ¢ ×¤×¢×™×œ â”‚ â€¢â€¢â€¢      â”‚  â”‚
â”‚  â”‚ ğŸ’° ×¨×•× ×™×ª ×©×œ×•×    â”‚ ronit@company.com   â”‚ ğŸ’° ×”× ×”"×—   â”‚ ğŸŸ¢ ×¤×¢×™×œ â”‚ â€¢â€¢â€¢      â”‚  â”‚
â”‚  â”‚ ğŸš› ×“×•×“ ××‘×¨×”×     â”‚ david@company.com   â”‚ ğŸš› × ×”×’     â”‚ ğŸŸ¡ ××•×©×”×”â”‚ â€¢â€¢â€¢      â”‚  â”‚
â”‚  â”‚ ğŸš› ××‘×™ ××–×¨×—×™     â”‚ avi@company.com     â”‚ ğŸš› × ×”×’     â”‚ ğŸ”´ ×—×¡×•× â”‚ â€¢â€¢â€¢      â”‚  â”‚
â”‚  â”‚ â³ chen@new.com  â”‚ -                   â”‚ ğŸ“‹ ×¡×“×¨×Ÿ    â”‚ â³ ×××ª×™×Ÿ â”‚ â€¢â€¢â€¢      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                  â”‚
â”‚                              [1] [2] [3] ... [10]                               â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ×ª×¤×¨×™×˜ ×¤×¢×•×œ×•×ª (â€¢â€¢â€¢)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ‘ï¸ ×¦×¤×™×™×” ×‘×¤×¨×˜×™×        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœï¸ ×¢×¨×•×š ×ª×¤×§×™×“          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â¸ï¸ ×”×©×”×” ××©×ª××©          â”‚  â† ×œ××©×ª××© ×¤×¢×™×œ
â”‚ â–¶ï¸ ×”×¤×¢×œ ××—×“×©           â”‚  â† ×œ××©×ª××© ××•×©×”×”
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸš« ×—×¡×•× ××©×ª××©          â”‚
â”‚ âœ… ×‘×˜×œ ×—×¡×™××”           â”‚  â† ×œ××©×ª××© ×—×¡×•×
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ”‘ ×”×¢×‘×¨ ×‘×¢×œ×•×ª          â”‚  â† ×¨×§ ×œ-Owner
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ—‘ï¸ ××—×§ ××©×ª××©           â”‚  â† ×¨×§ ×œ-Owner
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ×“×™××œ×•×’ ×”×©×”×™×”/×—×¡×™××”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸš« ×—×¡×™××ª ××©×ª××©                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  ××©×ª××©: ×“×•×“ ××‘×¨×”× (david@company.com)                       â”‚
â”‚  ×ª×¤×§×™×“ × ×•×›×—×™: × ×”×’                                           â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ ×¡×™×‘×ª ×”×—×¡×™××” *                                           â”‚â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚
â”‚  â”‚ â”‚ ×¡×™×•× ×”×¢×¡×§×”                                         â”‚ â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                              â”‚
â”‚  âš ï¸ ×©×™× ×œ×‘:                                                 â”‚
â”‚  â€¢ ×œ××©×ª××© ×–×” ×™×© 3 × ×¡×™×¢×•×ª ××©×•×™×›×•×ª ×‘×¢×ª×™×“                     â”‚
â”‚  â€¢ ×”× ×¡×™×¢×•×ª ×™×™×©××¨×• ××©×•×™×›×•×ª ×¢×“ ×©×ª×©× ×” ×™×“× ×™×ª                   â”‚
â”‚                                                              â”‚
â”‚  [ ] ×”×¡×¨ ×©×™×•×š ××›×œ ×”× ×¡×™×¢×•×ª ×”×¢×ª×™×“×™×•×ª                         â”‚
â”‚                                                              â”‚
â”‚                              [×‘×™×˜×•×œ]  [ğŸš« ×—×¡×•× ××©×ª××©]       â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ×“×™××œ×•×’ ×”×–×× ×”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    âœ‰ï¸ ×”×–×× ×ª ××©×ª××© ×—×“×©                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ ×›×ª×•×‘×ª ××™××™×™×œ *                                          â”‚â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚
â”‚  â”‚ â”‚ newuser@company.com                                â”‚ â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ ×ª×¤×§×™×“ *                                                 â”‚â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚
â”‚  â”‚ â”‚ ğŸ“‹ ×¡×“×¨×Ÿ                                        â–¼    â”‚ â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚
â”‚  â”‚   â—‹ ğŸ›¡ï¸ ×× ×”×œ - ×’×™×©×” ×œ×›×œ ×”××¢×¨×›×ª                          â”‚â”‚
â”‚  â”‚   â— ğŸ“‹ ×¡×“×¨×Ÿ - × ×™×”×•×œ × ×¡×™×¢×•×ª ×•×¦×™                         â”‚â”‚
â”‚  â”‚   â—‹ ğŸ’° ×”× ×”×œ×ª ×—×©×‘×•× ×•×ª - ×›×¡×¤×™× ×•×“×•×—×•×ª                    â”‚â”‚
â”‚  â”‚   â—‹ ğŸš› × ×”×’ - ××©×™××•×ª ×‘×œ×‘×“                                â”‚â”‚
â”‚  â”‚   â—‹ ğŸ‘ï¸ ×¦×•×¤×” - ×§×¨×™××” ×‘×œ×‘×“                                â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ ×”×•×“×¢×” ××™×©×™×ª (××•×¤×¦×™×•× ×œ×™)                                 â”‚â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚
â”‚  â”‚ â”‚ ×©×œ×•×! ×”×•×–×× ×ª ×œ×”×¦×˜×¨×£ ×œ××¢×¨×›×ª × ×™×”×•×œ ×”×”×•×‘×œ×•×ª ×©×œ× ×•     â”‚ â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                              â”‚
â”‚                              [×‘×™×˜×•×œ]  [ğŸ“¤ ×©×œ×— ×”×–×× ×”]        â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 10. ×ª×›× ×™×ª ×™×™×©×•×

### Phase 1: Backend MVP (1.5 ×©×‘×•×¢×•×ª)

```
Week 1:
â”œâ”€â”€ Day 1-2: Database Migration
â”‚   â”œâ”€â”€ ×¢×“×›×•×Ÿ ×˜×‘×œ×ª users (status, blocked_*, suspended_*)
â”‚   â”œâ”€â”€ ×˜×‘×œ×ª user_invitations
â”‚   â””â”€â”€ ×˜×‘×œ×ª permission_audit_logs
â”‚
â”œâ”€â”€ Day 3-4: Models & Schemas
â”‚   â”œâ”€â”€ ×¢×“×›×•×Ÿ User model
â”‚   â”œâ”€â”€ UserInvitation model
â”‚   â”œâ”€â”€ PermissionAuditLog model
â”‚   â””â”€â”€ Pydantic schemas
â”‚
â”œâ”€â”€ Day 5: Permission Service
â”‚   â”œâ”€â”€ has_permission(user, action, resource)
â”‚   â”œâ”€â”€ can_manage_user(actor, target)
â”‚   â””â”€â”€ get_user_permissions(user)

Week 2:
â”œâ”€â”€ Day 1-2: User Management API
â”‚   â”œâ”€â”€ GET /api/org/users
â”‚   â”œâ”€â”€ PATCH /api/org/users/{id}/role
â”‚   â”œâ”€â”€ POST /api/org/users/{id}/suspend
â”‚   â”œâ”€â”€ POST /api/org/users/{id}/block
â”‚   â””â”€â”€ POST /api/org/users/{id}/activate
â”‚
â”œâ”€â”€ Day 3: Invitation System
â”‚   â”œâ”€â”€ POST /api/org/users/invite
â”‚   â”œâ”€â”€ POST /api/invitations/{token}/accept
â”‚   â””â”€â”€ Email sending (or log for now)
â”‚
â””â”€â”€ Day 4-5: Audit & Testing
    â”œâ”€â”€ Audit logging middleware
    â”œâ”€â”€ Unit tests
    â””â”€â”€ Integration tests
```

### Phase 2: Frontend (1.5 ×©×‘×•×¢×•×ª)

```
Week 2-3:
â”œâ”€â”€ Day 1-2: User Management Page
â”‚   â”œâ”€â”€ Users list table
â”‚   â”œâ”€â”€ Status badges
â”‚   â””â”€â”€ Actions menu
â”‚
â”œâ”€â”€ Day 3-4: Dialogs & Forms
â”‚   â”œâ”€â”€ Invite user dialog
â”‚   â”œâ”€â”€ Change role dialog
â”‚   â”œâ”€â”€ Suspend/Block dialogs
â”‚   â””â”€â”€ Confirm dialogs
â”‚
â”œâ”€â”€ Day 5: Audit Log Page
â”‚   â”œâ”€â”€ Log table with filters
â”‚   â””â”€â”€ Export functionality
â”‚
Week 3:
â”œâ”€â”€ Day 1-2: Integration
â”‚   â”œâ”€â”€ API integration
â”‚   â”œâ”€â”€ Real-time updates
â”‚   â””â”€â”€ Toast notifications
â”‚
â””â”€â”€ Day 3-4: Polish & Testing
    â”œâ”€â”€ Error handling
    â”œâ”€â”€ Loading states
    â”œâ”€â”€ Mobile responsive
    â””â”€â”€ E2E tests
```

### Phase 3: Advanced Features (2 ×©×‘×•×¢×•×ª)

```
Week 4-5:
â”œâ”€â”€ Custom permissions per user
â”œâ”€â”€ Permission groups/templates
â”œâ”€â”€ Two-factor authentication (2FA)
â”œâ”€â”€ Login history & device management
â”œâ”€â”€ Session management (force logout)
â””â”€â”€ API keys for integrations
```

---

## ğŸ“Š ×¡×™×›×•×

### Deliverables

| ×¤×¨×™×˜ | ×–××Ÿ | ×¢×“×™×¤×•×ª |
|------|-----|--------|
| User status (suspend/block) | 3 ×™××™× | ğŸ”´ ×’×‘×•×”×” |
| Role management API | 2 ×™××™× | ğŸ”´ ×’×‘×•×”×” |
| Invitation system | 3 ×™××™× | ğŸŸ¡ ×‘×™× ×•× ×™×ª |
| Audit logging | 2 ×™××™× | ğŸŸ¡ ×‘×™× ×•× ×™×ª |
| Frontend - User management | 4 ×™××™× | ğŸ”´ ×’×‘×•×”×” |
| Frontend - Audit log | 2 ×™××™× | ğŸŸ¢ × ××•×›×” |
| **×¡×”"×› MVP** | **~3 ×©×‘×•×¢×•×ª** | |

### Success Metrics

- âœ… Owner ×™×›×•×œ ×œ×”×–××™×Ÿ/×œ×—×¡×•× ××©×ª××©×™×
- âœ… Admin ×™×›×•×œ ×œ× ×”×œ ××©×ª××©×™× (×—×•×¥ ×-Owner)
- âœ… ××©×ª××© ×—×¡×•× ×œ× ×™×›×•×œ ×œ×”×ª×—×‘×¨
- âœ… ×›×œ ×©×™× ×•×™ ×”×¨×©××” × ×¨×©× ×‘-Audit
- âœ… ×××©×§ ×‘×¨×•×¨ ×•×™×“×™×“×•×ª×™

---

## ğŸš€ ×”×¦×¢×“ ×”×‘×

××” ×ª×¨×¦×” ×©××ª×—×™×œ?

1. **Database Migration** - ×™×¦×™×¨×ª ×”×˜×‘×œ××•×ª ×”×—×“×©×•×ª
2. **User Model Update** - ×”×•×¡×¤×ª ×©×“×•×ª status/blocked
3. **Permission Service** - ×œ×•×’×™×§×ª ×”×”×¨×©××•×ª
4. **API Endpoints** - × ×™×”×•×œ ××©×ª××©×™×

×‘×—×¨ ×•××ª×—×™×œ! ğŸ—ï¸
